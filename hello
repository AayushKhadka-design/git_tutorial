updated the version 3 and made many changes
